todo
----
make queue thread safe